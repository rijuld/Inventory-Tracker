const { OAuth2Client } = require('google-auth-library');

const TESTING_CLIENT_ID = '436044657029-981nu0msfos152ot49rtculbipem77m2.apps.googleusercontent.com'
const FINAL_CLIENT_ID = '888865143339-1vju2lo5blk67n4qbsrt72pb9uc2huuc.apps.googleusercontent.com'
const FINAL_FINAL_CLIENT_ID = '1087616386064-bd9p6ckuedanccfcrfb5jk7u2qabl4t8.apps.googleusercontent.com'
const client = new OAuth2Client(TESTING_CLIENT_ID);

const ID_TOKEN = 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjE3OGFiMWRjNTkxM2Q5MjlkMzdjMjNkY2FhOTYxODcyZjhkNzBiNjgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI0MzYwNDQ2NTcwMjktOTgxbnUwbXNmb3MxNTJvdDQ5cnRjdWxiaXBlbTc3bTIuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI0MzYwNDQ2NTcwMjktOTgxbnUwbXNmb3MxNTJvdDQ5cnRjdWxiaXBlbTc3bTIuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDIwNTM1NjA4MTE2MDA2NTM2OTIiLCJoZCI6Imh5ZGVyYWJhZC5iaXRzLXBpbGFuaS5hYy5pbiIsImVtYWlsIjoiZjIwMTkwMTMwQGh5ZGVyYWJhZC5iaXRzLXBpbGFuaS5hYy5pbiIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiYy15VGxLSlNiTFhGaUxJdFNQNlRLQSIsIm5vbmNlIjoiNXJIci1fQnVyakJ0Sy1OcTRUcUdjc2NobVV5ckdIbHFFWWpma1loUHNSdyIsIm5hbWUiOiJBcnlhbiBDaGF1YmFsIiwicGljdHVyZSI6Imh0dHBzOi8vbGg0Lmdvb2dsZXVzZXJjb250ZW50LmNvbS8td3l1a0NzTGl4TkUvQUFBQUFBQUFBQUkvQUFBQUFBQUFBQUEvQU1adXVjazlsX3pLOTE4bzM2S05faVRyZHdMTW5XaVdaUS9zOTYtYy9waG90by5qcGciLCJnaXZlbl9uYW1lIjoiQXJ5YW4iLCJmYW1pbHlfbmFtZSI6IkNoYXViYWwiLCJsb2NhbGUiOiJlbiIsImlhdCI6MTYwMzU2NzkyNywiZXhwIjoxNjAzNTcxNTI3fQ.hoD2cdubB-yQMS9wA0BYyobqHp4Ce85D2qpx56GVFXgqZHeF41gIVo_cvlUj7OA_u7gphWglN72bqYprduafTsDEMzdTzHqpqYhvsNfXGtzLBW3lRotffLEawwDDQ7DirLdbXVgU6tipqJwRsnWGyouDI-Hc9RWEhEsi-7tmYAJ-Wxky_3hJD3LBC8nWT0sKVrwdIVsAoPjvWFzfmxKR5TisT5rSk9jLNjewWqGzvf2LJTo-_gtcR3fONCGcgQ-aGQHQ9sW6mwy4tnpKBsQvVUpWitiEzJOFoveXh6C7PRDpLFbRt_jrSQvTj0_TNa7qMrAwrjEJbKmuOFJ-j3puOA'



async function verifyIdToken(idToken) {
    const ticket = await client.verifyIdToken({
        idToken: idToken,
        audience: [TESTING_CLIENT_ID, FINAL_CLIENT_ID, FINAL_FINAL_CLIENT_ID],
    })
    const payload = ticket.getPayload()
    return payload
}


module.exports = {
    verifyIdToken: verifyIdToken
}